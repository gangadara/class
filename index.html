<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Studies A/L - Online Learning Portal</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        // Fallback if Firebase takes too long
        setTimeout(function() {
            var loading = document.getElementById('loadingScreen');
            if (loading && !loading.classList.contains('hidden') && typeof firebase === 'undefined') {
                loading.innerHTML = '<div style="text-align:center;padding:2rem;"><h2>Loading Error</h2><p>Please check your internet connection and refresh.</p><button onclick="location.reload()" style="padding:10px 20px;margin-top:10px;cursor:pointer;">Refresh</button></div>';
            }
        }, 10000);
    </script>
</head>
<body>
    <div id="app">
        <!-- Setup Screen removed - Firebase is preconfigured -->

        <!-- Loading Screen -->
        <div id="loadingScreen" class="loading-screen">
            <div class="loader">
                <i class="fas fa-graduation-cap fa-spin"></i>
                <p>Loading...</p>
            </div>
        </div>

        <!-- Login Page -->
        <div id="loginPage" class="login-page hidden">
            <div class="login-container">
                <div class="login-header">
                    <div class="login-logo" id="loginLogo">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h1 id="loginSiteName">Media Studies A/L</h1>
                    <p id="loginTagline">Online Learning Portal</p>
                </div>
                
                <div class="login-tabs">
                    <button class="tab-btn active" data-tab="student">
                        <i class="fas fa-user-graduate"></i> Student
                    </button>
                    <button class="tab-btn" data-tab="admin">
                        <i class="fas fa-user-shield"></i> Admin
                    </button>
                </div>

                <form id="loginForm" class="login-form">
                    <div class="form-group">
                        <label><i class="fas fa-envelope"></i> Email</label>
                        <input type="email" id="loginEmail" required placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-lock"></i> Password</label>
                        <input type="password" id="loginPassword" required placeholder="Enter your password">
                    </div>
                    <div id="loginError" class="error-message hidden"></div>
                    <button type="submit" class="btn btn-primary btn-lg btn-block">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </form>

                <div class="login-footer">
                    <p id="loginFooterText">Â© 2024 Media Studies A/L</p>
                </div>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon"></i>
            </button>
        </div>

        <!-- Student Dashboard -->
        <div id="studentDashboard" class="dashboard hidden">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="logo" id="studentLogo">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h2 id="studentSiteName">Media Studies A/L</h2>
                </div>
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-page="dashboard">
                        <i class="fas fa-home"></i> Dashboard
                    </a>
                    <a href="#" class="nav-item" data-page="notes">
                        <i class="fas fa-file-alt"></i> Notes
                    </a>
                    <a href="#" class="nav-item" data-page="tutorials">
                        <i class="fas fa-book"></i> Tutorials
                    </a>
                    <a href="#" class="nav-item" data-page="videos">
                        <i class="fas fa-video"></i> Video Classes
                    </a>
                </nav>
                <div class="sidebar-footer">
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </aside>
            
            <main class="main-content">
                <header class="top-header">
                    <button class="menu-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="header-title">
                        <h1 id="pageTitle">Dashboard</h1>
                    </div>
                    <div class="header-actions">
                        <button class="theme-toggle" onclick="toggleTheme()">
                            <i class="fas fa-moon"></i>
                        </button>
                        <div class="user-info">
                            <span id="studentName">Student</span>
                            <span id="studentBadge" class="badge badge-success">Paid</span>
                        </div>
                    </div>
                </header>

                <div class="content-area">
                    <!-- Dashboard Page -->
                    <div id="dashboardPage" class="page active">
                        <!-- Notices & Banners -->
                        <div id="noticesSection" class="notices-section hidden">
                            <div id="bannersContainer" class="banners-container"></div>
                            <div id="noticesContainer" class="notices-container"></div>
                        </div>

                        <div class="welcome-card">
                            <div class="welcome-content">
                                <h2>Welcome back, <span id="welcomeName">Student</span>! ðŸ‘‹</h2>
                                <p>Continue your learning journey in Media Studies</p>
                            </div>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
                                <div class="stat-info">
                                    <h3 id="statNotes">0</h3>
                                    <p>Notes Available</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-book"></i></div>
                                <div class="stat-info">
                                    <h3 id="statTutes">0</h3>
                                    <p>Tutorials</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-video"></i></div>
                                <div class="stat-info">
                                    <h3 id="statVideos">0</h3>
                                    <p>Video Classes</p>
                                </div>
                            </div>
                        </div>

                        <div class="quick-actions">
                            <h3>Quick Actions</h3>
                            <div class="action-buttons">
                                <button class="action-btn" onclick="showPage('notes')">
                                    <i class="fas fa-file-alt"></i>
                                    <span>View Notes</span>
                                </button>
                                <button class="action-btn" onclick="showPage('tutorials')">
                                    <i class="fas fa-book"></i>
                                    <span>View Tutorials</span>
                                </button>
                                <button class="action-btn" onclick="showPage('videos')">
                                    <i class="fas fa-video"></i>
                                    <span>Watch Videos</span>
                                </button>
                            </div>
                        </div>

                        <!-- About Teacher Section -->
                        <div id="aboutTeacherSection" class="about-teacher-section hidden">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Notes Page -->
                    <div id="notesPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-file-alt"></i> Study Notes</h2>
                            <div class="filters">
                                <select id="notesAccessFilter" onchange="filterNotes()">
                                    <option value="all">All Notes</option>
                                    <option value="free">Free Only</option>
                                    <option value="paid">Paid Only</option>
                                </select>
                                <select id="notesMonthFilter" onchange="filterNotes()">
                                    <option value="all">All Months</option>
                                </select>
                            </div>
                        </div>
                        <div id="notesList" class="content-grid">
                            <div class="empty-state">
                                <i class="fas fa-file-alt"></i>
                                <p>No notes available yet</p>
                            </div>
                        </div>
                    </div>

                    <!-- Tutorials Page -->
                    <div id="tutorialsPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-book"></i> Tutorials</h2>
                            <div class="filters">
                                <select id="tutesTypeFilter" onchange="filterTutes()">
                                    <option value="all">All Types</option>
                                    <option value="new">New Tutorials</option>
                                    <option value="old">Old Papers</option>
                                </select>
                                <select id="tutesAccessFilter" onchange="filterTutes()">
                                    <option value="all">All Access</option>
                                    <option value="free">Free Only</option>
                                    <option value="paid">Paid Only</option>
                                </select>
                                <select id="tutesMonthFilter" onchange="filterTutes()">
                                    <option value="all">All Months</option>
                                </select>
                            </div>
                        </div>
                        <div id="tutesList" class="content-grid">
                            <div class="empty-state">
                                <i class="fas fa-book"></i>
                                <p>No tutorials available yet</p>
                            </div>
                        </div>
                    </div>

                    <!-- Videos Page -->
                    <div id="videosPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-video"></i> Video Classes</h2>
                            <div class="filters">
                                <select id="videosAccessFilter" onchange="filterVideos()">
                                    <option value="all">All Videos</option>
                                    <option value="free">Free Only</option>
                                    <option value="paid">Paid Only</option>
                                </select>
                                <select id="videosMonthFilter" onchange="filterVideos()">
                                    <option value="all">All Months</option>
                                </select>
                            </div>
                        </div>
                        <div id="videosList" class="content-grid">
                            <div class="empty-state">
                                <i class="fas fa-video"></i>
                                <p>No videos available yet</p>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="dashboard hidden">
            <aside class="sidebar admin-sidebar">
                <div class="sidebar-header">
                    <div class="logo">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <h2>Admin Panel</h2>
                </div>
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-page="admin-overview">
                        <i class="fas fa-chart-line"></i> Overview
                    </a>
                    <a href="#" class="nav-item" data-page="admin-branding">
                        <i class="fas fa-palette"></i> Branding
                    </a>
                    <a href="#" class="nav-item" data-page="admin-notices">
                        <i class="fas fa-bullhorn"></i> Notices
                    </a>
                    <a href="#" class="nav-item" data-page="admin-students">
                        <i class="fas fa-users"></i> Students
                    </a>
                    <a href="#" class="nav-item" data-page="admin-notes">
                        <i class="fas fa-sticky-note"></i> Notes
                    </a>
                    <a href="#" class="nav-item" data-page="admin-tutes">
                        <i class="fas fa-book"></i> Tutorials
                    </a>
                    <a href="#" class="nav-item" data-page="admin-videos">
                        <i class="fas fa-video"></i> Videos
                    </a>
                    <a href="#" class="nav-item" data-page="admin-settings">
                        <i class="fas fa-cog"></i> Settings
                    </a>
                </nav>
                <div class="sidebar-footer">
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </aside>
            
            <main class="main-content">
                <header class="top-header">
                    <button class="menu-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="header-title">
                        <h1 id="adminPageTitle">Overview</h1>
                    </div>
                    <div class="header-actions">
                        <button class="theme-toggle" onclick="toggleTheme()">
                            <i class="fas fa-moon"></i>
                        </button>
                        <div class="user-info">
                            <span>Administrator</span>
                        </div>
                    </div>
                </header>

                <div class="content-area">
                    <!-- Admin Overview -->
                    <div id="admin-overviewPage" class="page active">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-users"></i></div>
                                <div class="stat-info">
                                    <h3 id="adminStatStudents">0</h3>
                                    <p>Total Students</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                                <div class="stat-info">
                                    <h3 id="adminStatPaid">0</h3>
                                    <p>Paid Students</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
                                <div class="stat-info">
                                    <h3 id="adminStatNotes">0</h3>
                                    <p>Notes</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-book"></i></div>
                                <div class="stat-info">
                                    <h3 id="adminStatTutes">0</h3>
                                    <p>Tutorials</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-video"></i></div>
                                <div class="stat-info">
                                    <h3 id="adminStatVideos">0</h3>
                                    <p>Videos</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-bullhorn"></i></div>
                                <div class="stat-info">
                                    <h3 id="adminStatNotices">0</h3>
                                    <p>Active Notices</p>
                                </div>
                            </div>
                        </div>

                        <div class="admin-quick-actions">
                            <h3>Quick Actions</h3>
                            <div class="action-buttons">
                                <button class="action-btn" onclick="showAdminPage('admin-students'); openAddStudentModal()">
                                    <i class="fas fa-user-plus"></i>
                                    <span>Add Student</span>
                                </button>
                                <button class="action-btn" onclick="showAdminPage('admin-notes'); openAddNoteModal()">
                                    <i class="fas fa-file-plus"></i>
                                    <span>Add Note</span>
                                </button>
                                <button class="action-btn" onclick="showAdminPage('admin-videos'); openAddVideoModal()">
                                    <i class="fas fa-video"></i>
                                    <span>Add Video</span>
                                </button>
                                <button class="action-btn" onclick="showAdminPage('admin-notices'); openAddNoticeModal()">
                                    <i class="fas fa-bullhorn"></i>
                                    <span>Add Notice</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Admin Branding -->
                    <div id="admin-brandingPage" class="page hidden">
                        <div class="form-card">
                            <h3><i class="fas fa-info-circle"></i> Basic Information</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Site Name</label>
                                    <input type="text" id="brandSiteName" placeholder="Media Studies A/L">
                                </div>
                                <div class="form-group">
                                    <label>Teacher Name</label>
                                    <input type="text" id="brandTeacherName" placeholder="Mr. John Doe">
                                </div>
                                <div class="form-group">
                                    <label>Class Name</label>
                                    <input type="text" id="brandClassName" placeholder="Media Studies 2024">
                                </div>
                                <div class="form-group">
                                    <label>Tagline</label>
                                    <input type="text" id="brandTagline" placeholder="Online Learning Portal">
                                </div>
                            </div>
                        </div>

                        <div class="form-card">
                            <h3><i class="fas fa-image"></i> Logo</h3>
                            <div class="logo-upload">
                                <div class="logo-preview" id="logoPreview">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="logo-actions">
                                    <input type="file" id="logoFile" accept="image/*" onchange="handleLogoUpload(event)" hidden>
                                    <button class="btn btn-outline" onclick="document.getElementById('logoFile').click()">
                                        <i class="fas fa-upload"></i> Upload Logo
                                    </button>
                                    <button class="btn btn-outline" onclick="removeLogo()">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="form-card">
                            <h3><i class="fas fa-palette"></i> Theme Colors</h3>
                            <div class="color-presets">
                                <button class="color-preset" style="background: linear-gradient(135deg, #6366f1, #8b5cf6)" onclick="applyColorPreset('#6366f1', '#8b5cf6')"></button>
                                <button class="color-preset" style="background: linear-gradient(135deg, #3b82f6, #06b6d4)" onclick="applyColorPreset('#3b82f6', '#06b6d4')"></button>
                                <button class="color-preset" style="background: linear-gradient(135deg, #10b981, #059669)" onclick="applyColorPreset('#10b981', '#059669')"></button>
                                <button class="color-preset" style="background: linear-gradient(135deg, #f59e0b, #d97706)" onclick="applyColorPreset('#f59e0b', '#d97706')"></button>
                                <button class="color-preset" style="background: linear-gradient(135deg, #ef4444, #dc2626)" onclick="applyColorPreset('#ef4444', '#dc2626')"></button>
                                <button class="color-preset" style="background: linear-gradient(135deg, #ec4899, #be185d)" onclick="applyColorPreset('#ec4899', '#be185d')"></button>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Primary Color</label>
                                    <input type="color" id="brandPrimaryColor" value="#6366f1">
                                </div>
                                <div class="form-group">
                                    <label>Secondary Color</label>
                                    <input type="color" id="brandSecondaryColor" value="#8b5cf6">
                                </div>
                            </div>
                        </div>

                        <div class="form-card">
                            <h3><i class="fas fa-address-card"></i> Contact Information</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-envelope"></i> Email</label>
                                    <input type="email" id="brandEmail" placeholder="teacher@email.com">
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-phone"></i> Phone</label>
                                    <input type="text" id="brandPhone" placeholder="+94 77 123 4567">
                                </div>
                                <div class="form-group">
                                    <label><i class="fab fa-whatsapp"></i> WhatsApp</label>
                                    <input type="text" id="brandWhatsApp" placeholder="+94 77 123 4567">
                                </div>
                                <div class="form-group">
                                    <label><i class="fab fa-facebook"></i> Facebook</label>
                                    <input type="text" id="brandFacebook" placeholder="https://facebook.com/page">
                                </div>
                                <div class="form-group">
                                    <label><i class="fab fa-youtube"></i> YouTube</label>
                                    <input type="text" id="brandYouTube" placeholder="https://youtube.com/channel">
                                </div>
                            </div>
                        </div>

                        <div class="form-card">
                            <h3><i class="fas fa-shoe-prints"></i> Footer</h3>
                            <div class="form-group">
                                <label>Footer Text</label>
                                <input type="text" id="brandFooter" placeholder="Â© 2024 Media Studies A/L. All rights reserved.">
                            </div>
                        </div>

                        <button class="btn btn-primary btn-lg" onclick="saveBranding()">
                            <i class="fas fa-save"></i> Save Branding
                        </button>
                    </div>

                    <!-- Admin Notices -->
                    <div id="admin-noticesPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-bullhorn"></i> Notices & Banners</h2>
                            <button class="btn btn-primary" onclick="openAddNoticeModal()">
                                <i class="fas fa-plus"></i> Add Notice/Banner
                            </button>
                        </div>
                        <div id="adminNoticesList" class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Type</th>
                                        <th>Title/Content</th>
                                        <th>Priority</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="noticesTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Admin Students -->
                    <div id="admin-studentsPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-users"></i> Manage Students</h2>
                            <button class="btn btn-primary" onclick="openAddStudentModal()">
                                <i class="fas fa-user-plus"></i> Add Student
                            </button>
                        </div>
                        <div id="adminStudentsList" class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Status</th>
                                        <th>Expiry</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="studentsTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Admin Notes -->
                    <div id="admin-notesPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-file-alt"></i> Manage Notes</h2>
                            <button class="btn btn-primary" onclick="openAddNoteModal()">
                                <i class="fas fa-plus"></i> Add Note
                            </button>
                        </div>
                        <div id="adminNotesList" class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Month</th>
                                        <th>Access</th>
                                        <th>Download</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="notesTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Admin Tutorials -->
                    <div id="admin-tutesPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-book"></i> Manage Tutorials</h2>
                            <button class="btn btn-primary" onclick="openAddTuteModal()">
                                <i class="fas fa-plus"></i> Add Tutorial
                            </button>
                        </div>
                        <div id="adminTutesList" class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Type</th>
                                        <th>Month</th>
                                        <th>Access</th>
                                        <th>Download</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="tutesTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Admin Videos -->
                    <div id="admin-videosPage" class="page hidden">
                        <div class="page-header">
                            <h2><i class="fas fa-video"></i> Manage Videos</h2>
                            <button class="btn btn-primary" onclick="openAddVideoModal()">
                                <i class="fas fa-plus"></i> Add Video
                            </button>
                        </div>
                        <div id="adminVideosList" class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Type</th>
                                        <th>Month</th>
                                        <th>Access</th>
                                        <th>Download</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="videosTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Admin Settings -->
                    <div id="admin-settingsPage" class="page hidden">
                        <div class="form-card">
                            <h3><i class="fas fa-key"></i> Change Admin Credentials</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Admin Email</label>
                                    <input type="email" id="adminEmail" placeholder="admin@admin.com">
                                </div>
                                <div class="form-group">
                                    <label>New Password</label>
                                    <input type="password" id="adminPassword" placeholder="Leave blank to keep current">
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="updateAdminCredentials()">
                                <i class="fas fa-save"></i> Update Credentials
                            </button>
                        </div>

                        <div class="form-card">
                            <h3><i class="fas fa-database"></i> Backup & Restore</h3>
                            <p class="text-muted">Export your data as a backup or restore from a previous backup.</p>
                            <div style="display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="exportBackup()">
                                    <i class="fas fa-download"></i> Export Backup
                                </button>
                                <button class="btn btn-outline" onclick="importBackup()">
                                    <i class="fas fa-upload"></i> Import Backup
                                </button>
                                <input type="file" id="backupFileInput" accept=".json" onchange="handleBackupFile(event)" hidden>
                            </div>
                        </div>

                        <div class="form-card danger-zone">
                            <h3><i class="fas fa-exclamation-triangle"></i> Danger Zone</h3>
                            <p class="text-muted">These actions cannot be undone.</p>
                            <button class="btn btn-danger" onclick="resetAllData()">
                                <i class="fas fa-trash"></i> Reset All Data
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Video Player Modal -->
        <div id="videoModal" class="modal hidden">
            <div class="modal-content video-modal-content">
                <div class="modal-header">
                    <h3 id="videoModalTitle">Video</h3>
                    <button class="modal-close" onclick="closeVideoModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body video-modal-body">
                    <div id="videoContainer" class="video-container">
                        <!-- Video will be inserted here -->
                    </div>
                    <div class="video-watermark" id="videoWatermark"></div>
                    <div class="video-protection-notice">
                        <i class="fas fa-shield-alt"></i> Protected Content - Do not share or record
                    </div>
                </div>
            </div>
        </div>

        <!-- PDF Viewer Modal -->
        <div id="pdfModal" class="modal hidden">
            <div class="modal-content pdf-modal-content">
                <div class="modal-header">
                    <h3 id="pdfModalTitle">Document</h3>
                    <div class="modal-header-actions">
                        <button id="pdfDownloadBtn" class="btn btn-primary btn-sm hidden" onclick="downloadCurrentPdf()">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="modal-close" onclick="closePdfModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="modal-body pdf-modal-body">
                    <iframe id="pdfViewer" src=""></iframe>
                </div>
            </div>
        </div>

        <!-- Add/Edit Student Modal -->
        <div id="studentModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="studentModalTitle">Add Student</h3>
                    <button class="modal-close" onclick="closeStudentModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="studentForm">
                        <input type="hidden" id="studentId">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" id="studentFormName" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="studentFormEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Password *</label>
                            <input type="password" id="studentFormPassword" required>
                        </div>
                        <div class="form-group">
                            <label>Phone</label>
                            <input type="text" id="studentFormPhone">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Status</label>
                                <select id="studentFormStatus">
                                    <option value="free">Free Student</option>
                                    <option value="paid">Paid Student</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Expiry Date</label>
                                <input type="date" id="studentFormExpiry">
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="closeStudentModal()">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Student</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Add/Edit Note Modal -->
        <div id="noteModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="noteModalTitle">Add Note</h3>
                    <button class="modal-close" onclick="closeNoteModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="noteForm">
                        <input type="hidden" id="noteId">
                        <div class="form-group">
                            <label>Title *</label>
                            <input type="text" id="noteFormTitle" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="noteFormDescription" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Month *</label>
                            <input type="month" id="noteFormMonth" required>
                        </div>
                        <div class="form-group">
                            <label>PDF File *</label>
                            <input type="file" id="noteFormFile" accept=".pdf" onchange="handleNoteFileUpload(event)">
                            <input type="hidden" id="noteFormFileData">
                            <small class="file-name" id="noteFileName"></small>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Access</label>
                                <select id="noteFormAccess">
                                    <option value="free">Free</option>
                                    <option value="paid">Paid Only</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Allow Download</label>
                                <select id="noteFormDownloadable">
                                    <option value="true">Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="closeNoteModal()">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Note</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Add/Edit Tutorial Modal -->
        <div id="tuteModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="tuteModalTitle">Add Tutorial</h3>
                    <button class="modal-close" onclick="closeTuteModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="tuteForm">
                        <input type="hidden" id="tuteId">
                        <div class="form-group">
                            <label>Title *</label>
                            <input type="text" id="tuteFormTitle" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="tuteFormDescription" rows="3"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Type *</label>
                                <select id="tuteFormType" required>
                                    <option value="new">New Tutorial</option>
                                    <option value="old">Old Paper</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Month *</label>
                                <input type="month" id="tuteFormMonth" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>PDF File *</label>
                            <input type="file" id="tuteFormFile" accept=".pdf" onchange="handleTuteFileUpload(event)">
                            <input type="hidden" id="tuteFormFileData">
                            <small class="file-name" id="tuteFileName"></small>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Access</label>
                                <select id="tuteFormAccess">
                                    <option value="free">Free</option>
                                    <option value="paid">Paid Only</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Allow Download</label>
                                <select id="tuteFormDownloadable">
                                    <option value="true">Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="closeTuteModal()">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Tutorial</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Add/Edit Video Modal -->
        <div id="videoFormModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="videoFormModalTitle">Add Video</h3>
                    <button class="modal-close" onclick="closeVideoFormModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="videoForm">
                        <input type="hidden" id="videoId">
                        <div class="form-group">
                            <label>Title *</label>
                            <input type="text" id="videoFormTitle" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="videoFormDescription" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Month *</label>
                            <input type="month" id="videoFormMonth" required>
                        </div>
                        <div class="form-group">
                            <label>Video Source *</label>
                            <div class="video-source-tabs">
                                <button type="button" class="source-tab active" id="tabYoutube" onclick="switchVideoSource('youtube')">
                                    <i class="fab fa-youtube"></i> YouTube
                                </button>
                                <button type="button" class="source-tab" id="tabGdrive" onclick="switchVideoSource('gdrive')">
                                    <i class="fab fa-google-drive"></i> Google Drive
                                </button>
                                <button type="button" class="source-tab" id="tabFile" onclick="switchVideoSource('file')">
                                    <i class="fas fa-file-video"></i> Upload File
                                </button>
                            </div>
                        </div>
                        <div id="youtubeSourceInput" class="form-group video-source-input">
                            <label><i class="fab fa-youtube" style="color:#ff0000"></i> YouTube URL *</label>
                            <input type="url" id="videoFormYouTube" placeholder="https://www.youtube.com/watch?v=xxxxx">
                            <small class="text-muted">Paste any YouTube video URL (regular, short, or embed link)</small>
                        </div>
                        <div id="gdriveSourceInput" class="form-group video-source-input hidden">
                            <label><i class="fab fa-google-drive" style="color:#4285f4"></i> Google Drive URL *</label>
                            <input type="url" id="videoFormGDrive" placeholder="https://drive.google.com/file/d/xxxxx/view">
                            <small class="text-muted">Share file as "Anyone with the link can view" first, then paste link here</small>
                        </div>
                        <div id="fileSourceInput" class="form-group video-source-input hidden">
                            <label><i class="fas fa-file-video" style="color:#10b981"></i> Upload Video File (Max 50MB)</label>
                            <input type="file" id="videoFormFile" accept="video/*" onchange="handleVideoFileUpload(event)">
                            <input type="hidden" id="videoFormFileData">
                            <small class="file-name" id="videoFileName"></small>
                            <small class="text-muted">Supported formats: MP4, WebM, MOV</small>
                        </div>
                        <div class="form-group">
                            <label>Thumbnail</label>
                            <input type="file" id="videoFormThumbnail" accept="image/*" onchange="handleThumbnailUpload(event)">
                            <input type="hidden" id="videoFormThumbnailData">
                            <div id="thumbnailPreview" class="thumbnail-preview hidden"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Access</label>
                                <select id="videoFormAccess">
                                    <option value="free">Free</option>
                                    <option value="paid">Paid Only</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Allow Download</label>
                                <select id="videoFormDownloadable">
                                    <option value="false">No</option>
                                    <option value="true">Yes</option>
                                </select>
                            </div>
                        </div>
                        <input type="hidden" id="videoFormSource" value="youtube">
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="closeVideoFormModal()">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Video</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Add/Edit Notice Modal -->
        <div id="noticeModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="noticeModalTitle">Add Notice</h3>
                    <button class="modal-close" onclick="closeNoticeModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="noticeForm">
                        <input type="hidden" id="noticeId">
                        <div class="form-group">
                            <label>Type *</label>
                            <select id="noticeFormType" required onchange="toggleNoticeFields()">
                                <option value="text">Text Notice</option>
                                <option value="banner">Image Banner</option>
                            </select>
                        </div>
                        <div id="textNoticeFields">
                            <div class="form-group">
                                <label>Title *</label>
                                <input type="text" id="noticeFormTitle">
                            </div>
                            <div class="form-group">
                                <label>Message *</label>
                                <textarea id="noticeFormMessage" rows="4"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Priority</label>
                                <select id="noticeFormPriority">
                                    <option value="normal">Normal</option>
                                    <option value="important">Important</option>
                                    <option value="urgent">Urgent</option>
                                </select>
                            </div>
                        </div>
                        <div id="bannerNoticeFields" class="hidden">
                            <div class="form-group">
                                <label>Banner Image *</label>
                                <input type="file" id="noticeFormImage" accept="image/*" onchange="handleBannerUpload(event)">
                                <input type="hidden" id="noticeFormImageData">
                                <div id="bannerPreview" class="banner-preview hidden"></div>
                            </div>
                            <div class="form-group">
                                <label>Link URL (optional)</label>
                                <input type="text" id="noticeFormLink" placeholder="https://...">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="noticeFormActive">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="closeNoticeModal()">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Notice</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div id="toast" class="toast hidden">
            <i class="fas fa-check-circle"></i>
            <span id="toastMessage">Success!</span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
